"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=_interopRequireDefault(require("vue"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var r=[],i=!0,a=!1,n=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw n}}return r}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _classPrivateFieldGet(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");var r=t.get(e);return r.get?r.get.call(e):r.value}function _classPrivateFieldSet(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");var i=t.get(e);if(i.set)i.set.call(e,r);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=r}return r}var nsel=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),_defaultOptions.set(this,{writable:!0,value:{separator:"."}}),_ee.set(this,{writable:!0,value:void 0}),_listeners.set(this,{writable:!0,value:{}}),_aoListeners.set(this,{writable:!0,value:new WeakMap}),_options.set(this,{writable:!0,value:void 0}),_classPrivateFieldSet(this,_ee,new _vue.default),_classPrivateFieldSet(this,_options,_objectSpread({},_classPrivateFieldGet(this,_defaultOptions),e))}return _createClass(t,[{key:"_namespace",value:function(e,i){var a=this;"object"!==_typeof(e)&&(e=[e]);var n=[];return e.forEach(function(e){var t=e.split(_classPrivateFieldGet(a,_options).separator),r=t.shift();n.push(r),t.length||t.push("__no-ns__"),t.forEach(function(e){_classPrivateFieldGet(a,_listeners)[r]||(_classPrivateFieldGet(a,_listeners)[r]={}),_classPrivateFieldGet(a,_listeners)[r][e]||(_classPrivateFieldGet(a,_listeners)[r][e]=[]),_classPrivateFieldGet(a,_listeners)[r][e].push(i)})}),n}},{key:"emit",value:function(){return _classPrivateFieldGet(this,_ee).$emit.apply(_classPrivateFieldGet(this,_ee),Array.prototype.slice.call(arguments)),this}},{key:"off",value:function(e,t){var d=this,r=0<arguments.length&&void 0!==e?e:[],o=1<arguments.length?t:void 0;return Array.isArray(r)||(r=[r]),r.length||r.push(""),r.forEach(function(e){var v=e.split(_classPrivateFieldGet(d,_options).separator),s=v.shift(),l=[],p=new WeakMap;Object.keys(_classPrivateFieldGet(d,_listeners)).forEach(function(r){if(!s||r===s)for(var e=0,t=Object.entries(_classPrivateFieldGet(d,_listeners)[r]);e<t.length;e++){var i=_slicedToArray(t[e],2),a=i[0],n=i[1];(!v.length||0<=v.indexOf(a))&&n.forEach(function(e){if(!o||o===e){var t=p.get(e);(t=t||{})[r]||(t[r]=0),t[r]++,p.set(e,t),-1==l.indexOf(e)&&l.push(e)}})}}),l.forEach(function(e){for(var t=p.get(e),r=0,i=Object.entries(t);r<i.length;r++){var a=_slicedToArray(i[r],2),n=a[0],s=a[1];if(!v.length||s===v.length){_classPrivateFieldGet(d,_ee).$off(n,e);for(var l=0,o=Object.entries(_classPrivateFieldGet(d,_listeners)[n]);l<o.length;l++){var c=_slicedToArray(o[l],2),f=c[0],u=c[1];0<=u.indexOf(e)&&(u.splice(u.indexOf(e),1),u.length||(delete _classPrivateFieldGet(d,_listeners)[n][f],Object.keys(_classPrivateFieldGet(d,_listeners)[n]).length||delete _classPrivateFieldGet(d,_listeners)[n]))}var _=_classPrivateFieldGet(d,_aoListeners).get(e);_&&_[n]&&_classPrivateFieldGet(d,_ee).$off(n,_[n])}}})}),this}},{key:"on",value:function(e,t){var r=this._namespace(e,t);return _classPrivateFieldGet(this,_ee).$on(r,t),this}},{key:"once",value:function(e,t){var r=this,i=this._namespace(e,t);_classPrivateFieldGet(this,_ee).$on(i,t);function a(){r.off(e,t)}_classPrivateFieldGet(this,_ee).$once(i[0],a);var n=_classPrivateFieldGet(this,_aoListeners).get(t);return(n=n||{})[i[0]]=a,_classPrivateFieldGet(this,_aoListeners).set(t,n),this}}]),t}(),_defaultOptions=new WeakMap,_ee=new WeakMap,_listeners=new WeakMap,_aoListeners=new WeakMap,_options=new WeakMap,_default=nsel;exports.default=_default;